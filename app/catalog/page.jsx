import Breadcrumbs from "@/components/breadcrumbs/Breadcrumbs"
import styles from "./page.module.css"
import Filter from "@/components/aside/filter/Filter"
import Link from "next/link"
import Image from "next/image"
import { Suspense } from "react"
import { prisma } from "@/db/prisma"
import { Loading } from "@/components/loading/Loading"

import ImgPesticides from "@/public/pesticides-juk.jpeg"
import ImgFertilizers from "@/public/fertilizers-1011.jpeg"
import ImgBiopreparaty from "@/public/bio-preparaty-1011.jpeg"
import ImgVspomogatelnye from "@/public/vspomogatelnye-preparaty-1011.jpeg"
import ImgSubstraty from "@/public/substraty-1011.jpeg"
import ImgLovushki from "@/public/lovushki-1011.jpeg"


export const metadata = {
	title: "Каталог | Next App",
	description: "Generated by create next app",
}


async function CategoryList() {
	const category = await prisma.category.findMany()

	return (
		<ul>
			{category?.map((category) => (
				<li key={category.id}>
					<Link className={styles.category_link}
						href={`/catalog/category/${category.slug}`}>
						{category.title}
					</Link>
				</li>
			))}
		</ul>
	)
}


function CatalogCard({ image, title }) {
	return (
		<div className={styles.category_items}>
			<div className={styles.category_img}>
				<div className={styles.category_info}>
					<h3>{title}</h3>
					<Link className={styles.all_link} href="#">
						Смотреть все<span className={styles.all_icon}> &#5125;</span>
					</Link>
				</div>
				<Image
					className={styles.image_category}
					src={image}
					alt="Изображение"
					width={400}
					height={200} />
			</div>

			<div className={styles.category_list}>
				<Suspense fallback={<p>Suspense...</p>}>
					<CategoryList />
				</Suspense>
			</div>
		</div>
	)
};


export default async function Catalog() {
	return (
		<>
			<Suspense fallback={<p>Suspense...</p>}>
				<Breadcrumbs>
					<h1 className={styles.h1}>Каталог</h1>
				</Breadcrumbs>
			</Suspense>
			<div className={styles.container}>
				<aside className={styles.aside}>
					<Filter />
				</aside>
				<div className={styles.body}>
					<div className={styles.category_row}>
						<CatalogCard
							title="Пестициды"
							image={ImgPesticides} />
						<CatalogCard
							title="Удобрения"
							image={ImgFertilizers} />
						<CatalogCard
							title="Биопрепараты"
							image={ImgBiopreparaty} />
						<CatalogCard
							title="Вспомогательные препараты"
							image={ImgVspomogatelnye} />
						<CatalogCard
							title="Для почвы"
							image={ImgSubstraty} />
						<CatalogCard
							title="Ловушки"
							image={ImgLovushki} />
					</div>
				</div>
			</div>
		</>
	)
};